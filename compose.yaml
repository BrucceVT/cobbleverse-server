services:
  mc:
    build: .
    container_name: cobbleverse
    restart: unless-stopped
    stdin_open: true
    tty: true

    ports:
      - "${SERVER_PORT:-25565}:25565"
      - "${RCON_PORT:-25575}:25575"

    environment:
      # ── Modpack ─────────────────────────────────
      MODRINTH_MODPACK: ${MODPACK_URL}

      # ── Resources ───────────────────────────────
      MEMORY: ${MEMORY:-4G}

      # ── Server settings ─────────────────────────
      DIFFICULTY: ${DIFFICULTY:-normal}
      MODE: ${MODE:-survival}
      MAX_PLAYERS: ${MAX_PLAYERS:-20}
      MOTD: ${MOTD:-§6Cobbleverse §7— §aCatch them all!}
      VIEW_DISTANCE: ${VIEW_DISTANCE:-10}
      SIMULATION_DISTANCE: ${SIMULATION_DISTANCE:-8}
      SEED: ${SEED:-}
      LEVEL: ${LEVEL:-world}
      ONLINE_MODE: ${ONLINE_MODE:-true}

      # ── RCON ────────────────────────────────────
      ENABLE_RCON: ${ENABLE_RCON:-true}
      RCON_PASSWORD: ${RCON_PASSWORD:-changeme-rcon-password}

      # ── Whitelist & OPs ─────────────────────────
      WHITELIST: ${WHITELIST:-}
      OPS: ${OPS:-}

      # ── Timezone ────────────────────────────────
      TZ: ${TZ:-UTC}

    volumes:
      - ./data:/data
      - ./extras:/extras:ro
      # itzg auto-copies /config → /data/config/
      - ./extras/config:/config:ro
      # scripts disponibles dentro del contenedor
      - ./scripts:/scripts:ro
      # itzg ejecuta init.d antes de arrancar el server
      - ./scripts/init-extras.sh:/itzg/init.d/init-extras.sh:ro
